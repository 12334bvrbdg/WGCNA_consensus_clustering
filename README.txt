
making a consensus network

---------------------------------------------------------------------------------
---------------------------------------------------------------------------------
---------------------------------------------------------------------------------

# 所需软件包

- WGCNA
- methods
- edgeR - 可能需要??
- RColorBrewer
- data.table
- pryr

---------------------------------------------------------------------------------
---------------------------------------------------------------------------------
---------------------------------------------------------------------------------

# 包含的文件

*********
## 注意：这些文件中包含硬编码的 ibis 服务器文件路径，您需要更改它们
*********

- make_subsamp_wgcna.py
- subsamp_wgcna.R
- seq_inidicator_mat.R
- seq_adding_mat.R
- merge_mats.R
- consensus_cluster.R

# 步骤 1 -- 生成子采样网络的 bash 文件
# 使用: make_subsamp_wgcna.py
#       subsamp_wgcna.R

########### 输入:
########### - 实验目录名称
########### - 基因名称列表
########### - 输入计数矩阵名称
########### - 采样次数
########### - 布尔值 ("rand" = T, 其他值 = F) 描述是否使用随机参数
###########   否则使用默认的硬编码参数

########### 输出:
########### - 在 /cbcb/project-scratch/ZCL/wgcna/ 中创建实验目录
########### - 创建子目录 sub_genes/, clusters/, ouput/, failed/, success/, 2many/, 和 bash/
########### - 包含每个基因被选择次数和采样次数的文件

########### 程序功能:
########### - 从网络中选择基因子集，并使用一些参数创建网络
########### - 生成 bash 文件以在实验目录的 bash/ 子目录中运行 subsamp_wgcna.R 脚本

# 然后运行生成的 bash 文件

# 步骤 2 生成指示矩阵（可以在网络运行时进行）
# 使用: seq_inidicator_mat.R ## 需要更改硬编码内容

########### 输入:
########### - exp_name - 由 make_subsamp_wgcna.py 创建的“实验”名称（需要更改硬编码路径）
########### - start 和 stop - 用于创建指示矩阵的基因样本列表的起始和结束编号
###########   这允许并行运行 seq_inidicator_matrix.R 以加速

########### 输出:
########### - 基因对基因矩阵，记录每对基因被共同采样的次数

# 步骤 3 生成共聚类矩阵
# 使用: seq_adding_mat.R ## 需要更改硬编码内容

########### 输入和输出与 seq_inidicator_mat.R 相同
########### - 但输出矩阵是基因对基因矩阵，记录每对基因被共同聚类的次数

# 步骤 4 合并并行生成的矩阵为一个指示矩阵和一个共聚类矩阵
# 使用: merge_mats.R

# 步骤 5 将共聚类矩阵除以指示矩阵，生成一个共识矩阵，其值范围为 [0,1]
# 这个矩阵可以用作距离值

# 步骤 6 使用 1 减去共识矩阵作为新的距离度量进行 WGCNA 聚类
# 使用: consensus_cluster.R


